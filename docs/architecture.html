<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weather Forecast Pro — Architecture & Flow</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin: 24px; color:#111 }
    header { text-align: center; margin-bottom: 18px }
    h1 { margin: 0; font-size: 28px }
    .subtitle { color: #666; margin-top: 6px }
    section { margin-top: 20px }
    .note { background:#f6f8fa; padding:12px; border-left:4px solid #667eea; border-radius:4px }
    pre { background: #111; color: #eee; padding:12px; overflow:auto }
    .diagram { border:1px solid #eee; padding:16px; border-radius:6px; background:white }
    footer { margin-top: 28px; color:#666; font-size:13px; text-align:center }
    @media print { .no-print { display:none } }
  </style>
  <!-- Mermaid CDN -->
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad:true, theme: 'default' });
  </script>
</head>
<body>
  <header>
    <h1>Weather Forecast Pro — Architecture & Flow</h1>
    <div class="subtitle">Printable documentation of system architecture, data flow, and file mapping</div>
  </header>

  <section>
    <h2>Overview</h2>
    <p>This document describes the runtime architecture and flow for your <strong>Weather Forecast Pro</strong> Streamlit application. Open this file in a browser, verify the diagrams render, then use <strong>Print → Save as PDF</strong> to create a printable PDF.</p>
    <div class="note">Tip: If diagrams do not render, ensure you have internet access for the Mermaid CDN. You can also copy the Mermaid code to <a href="https://mermaid.live/">mermaid.live</a>.</div>
  </section>

  <section>
    <h2>Architecture (Block Diagram)</h2>
    <div class="diagram">
      <!-- Mermaid Flowchart Block Diagram -->
      <div class="mermaid">
flowchart LR
  Browser["Browser / Client\n(User)"]
  Stream["Streamlit App\n(Frontend + App Logic)"]
  Secrets["Local Secrets\n(.streamlit/secrets.toml)"]
  OWM["OpenWeatherMap API\n(External Service)"]
  Git["GitHub Repository\n(Code + Docs)"]

  Browser <--> Stream
  Stream --> Secrets
  Stream <--> OWM
  Stream <--> Git
      </div>
    </div>
  </section>

  <section>
    <h2>Runtime Flow (High-level)</h2>
    <div class="diagram">
      <div class="mermaid">
flowchart TD
  A[User (Browser)] -->|Open page / submit city| B[Streamlit App UI]
  B --> |get_current_weather(city)| C[App Logic]
  C --> |HTTP GET /weather?q=...| D[OpenWeatherMap API]
  D --> |JSON| C
  C --> |parse -> DataFrame| E[Data Processing]
  E --> |plotly figures| F[Charts & Metrics]
  F --> |render| B
  B --> |display| A
  C --> |reads| Secrets[.streamlit/secrets.toml]
      </div>
    </div>
  </section>

  <section>
    <h2>Sequence Diagram (Request timeline)</h2>
    <div class="diagram">
      <div class="mermaid">
sequenceDiagram
  participant Browser
  participant Streamlit
  participant AppLogic
  participant OpenWeatherMap
  Browser->>Streamlit: Request page / submit form
  Streamlit->>AppLogic: get_current_weather(city)
  AppLogic->>OpenWeatherMap: HTTP GET /weather?q=city&appid=KEY
  OpenWeatherMap-->>AppLogic: JSON response
  AppLogic-->>Streamlit: DataFrame + Plotly figures
  Streamlit-->>Browser: Rendered UI (HTML + JS)
      </div>
    </div>
  </section>

  <section>
    <h2>File Mapping & Implementation Notes</h2>
    <ul>
      <li><strong>`app.py`</strong> — Streamlit entry point: UI layout, sidebar, calls to helpers, plotting (Plotly).</li>
      <li><strong>`.streamlit/secrets.toml`</strong> — Contains <code>MY_API_KEY</code>. Excluded from git via <code>.gitignore</code>.</li>
      <li><strong>`requirements.txt`</strong> — Lists Python dependencies: streamlit, plotly, pandas, requests, numpy.</li>
      <li><strong>`docs/architecture.html`</strong> — (this file) printable architecture & flow documentation.</li>
    </ul>

    <p><strong>Notes on running:</strong> For local dev, run <code>streamlit run app.py</code> and open <code>http://localhost:8501</code>. For production, use Streamlit Cloud, Docker, or a PaaS and set the API key in the host's secret manager.</p>
  </section>

  <section>
    <h2>How to Export to PDF</h2>
    <ol>
      <li>Open this file in your browser (double-click or use the Files view in your project).</li>
      <li>Make sure diagrams are rendered (they should appear automatically).</li>
      <li>Choose <strong>File → Print</strong> (or press Ctrl/Cmd+P).</li>
      <li>Select <strong>Save as PDF</strong> and export.</li>
    </ol>
    <p class="note">Alternative: copy the Mermaid blocks to <a href="https://mermaid.live/">mermaid.live</a> and export PNG/SVG there, then include in a PDF document.</p>
  </section>

  <footer>
    Generated for <strong>Weather Forecast Pro</strong> — <em>open the file and print to PDF</em>
  </footer>
</body>
</html>
